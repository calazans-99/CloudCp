<!doctype html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>DimDim Admin (CP2)</title>
  <style>
    body{font-family: system-ui, sans-serif; max-width: 980px; margin: 20px auto; padding: 0 16px;}
    header{display:flex; align-items:center; justify-content:space-between; margin-bottom:12px}
    .card{border:1px solid #ddd; border-radius:12px; padding:16px; margin:10px 0; box-shadow: 0 1px 4px rgba(0,0,0,.04)}
    input,button,textarea{padding:10px; border-radius:8px; border:1px solid #ccc}
    button{cursor:pointer}
    .row{display:grid; grid-template-columns: 1fr 1fr; gap:12px}
    pre{background:#111; color:#0f0; padding:10px; border-radius:8px; overflow:auto}
    .muted{opacity:.7}
    label{font-size:12px; color:#555}
  </style>
</head>
<body>
<header>
  <h2>DimDim Admin</h2>
  <div>
    <label for="api">API Base</label>
    <input id="api" size="40" />
  </div>
</header>

<div class="card">
  <h3>Clientes</h3>
  <div class="row">
    <div>
      <h4>Criar</h4>
      <input id="c-nome" placeholder="Nome" /><br/><br/>
      <input id="c-email" placeholder="Email" /><br/><br/>
      <button onclick="criarCliente()">POST /clientes</button>
    </div>
    <div>
      <h4>Buscar / Listar</h4>
      <input id="c-id" placeholder="ID" /><button onclick="buscarCliente()">GET /clientes/{id}</button>
      <br/><br/>
      <button onclick="listarClientes()">GET /clientes</button>
    </div>
  </div>
  <div>
    <h4>Atualizar / Excluir</h4>
    <input id="c-id2" placeholder="ID" />
    <input id="c-nome2" placeholder="Nome" />
    <input id="c-email2" placeholder="Email" />
    <button onclick="atualizarCliente()">PUT /clientes/{id}</button>
    <button onclick="excluirCliente()">DELETE /clientes/{id}</button>
  </div>
</div>

<div class="card">
  <h3>Pedidos</h3>
  <div class="row">
    <div>
      <h4>Criar Pedido</h4>
      <input id="p-cliente" placeholder="clienteId" /><br/><br/>
      <textarea id="p-itens" rows="6" placeholder='[{"descricao":"Mouse","quantidade":2,"valorUnitario":49.9}]'></textarea><br/><br/>
      <button onclick="criarPedido()">POST /pedidos</button>
    </div>
    <div>
      <h4>Buscar / Listar</h4>
      <input id="p-id" placeholder="ID" /><button onclick="buscarPedido()">GET /pedidos/{id}</button>
      <br/><br/>
      <button onclick="listarPedidos()">GET /pedidos</button>
    </div>
  </div>
  <div>
    <h4>Atualizar</h4>
    <input id="p-id2" placeholder="ID" />
    <input id="p-status" placeholder="status (NOVO,PAGO,CANCELADO)" />
    <textarea id="p-itens2" rows="4" placeholder='[{"descricao":"Headset","quantidade":1,"valorUnitario":199.0}] (opcional)'></textarea>
    <button onclick="atualizarPedido()">PUT /pedidos/{id}</button>
    <button onclick="atualizarStatus()">PUT /pedidos/{id}/status</button>
    <button onclick="excluirPedido()">DELETE /pedidos/{id}</button>
  </div>
</div>

<div class="card">
  <h4>Resposta</h4>
  <pre id="out" class="muted">aguardando...</pre>
</div>

<script>
const defaultApi = window.location.origin + "/api/v1";
const apiInput = document.getElementById('api');
apiInput.value = defaultApi;

function api(){ return apiInput.value; }
function out(x){ document.getElementById('out').textContent = typeof x === 'string' ? x : JSON.stringify(x, null, 2); }

async function criarCliente(){
  const body = { nome: document.getElementById('c-nome').value, email: document.getElementById('c-email').value };
  const r = await fetch(api()+"/clientes",{method:"POST", headers:{'Content-Type':'application/json'}, body: JSON.stringify(body)});
  out(await r.json());
}
async function listarClientes(){ const r=await fetch(api()+"/clientes"); out(await r.json()); }
async function buscarCliente(){ const id=document.getElementById('c-id').value; const r=await fetch(api()+"/clientes/"+id); out(await r.json()); }
async function atualizarCliente(){
  const id=document.getElementById('c-id2').value;
  const body={nome:document.getElementById('c-nome2').value, email:document.getElementById('c-email2').value};
  const r=await fetch(api()+"/clientes/"+id,{method:"PUT", headers:{'Content-Type':'application/json'}, body: JSON.stringify(body)});
  out(await r.json());
}
async function excluirCliente(){ const id=document.getElementById('c-id2').value; const r=await fetch(api()+"/clientes/"+id,{method:"DELETE"}); out({status:r.status}); }

async function criarPedido(){
  const body = { clienteId: parseInt(document.getElementById('p-cliente').value,10),
                 itens: JSON.parse(document.getElementById('p-itens').value) };
  const r = await fetch(api()+"/pedidos",{method:"POST", headers:{'Content-Type':'application/json'}, body: JSON.stringify(body)});
  out(await r.json());
}
async function listarPedidos(){ const r=await fetch(api()+"/pedidos"); out(await r.json()); }
async function buscarPedido(){ const id=document.getElementById('p-id').value; const r=await fetch(api()+"/pedidos/"+id); out(await r.json()); }
async function atualizarPedido(){
  const id=document.getElementById('p-id2').value;
  const s=document.getElementById('p-status').value.trim(); const status = s? s : null;
  const txt=document.getElementById('p-itens2').value.trim();
  const itens = txt ? JSON.parse(txt) : null;
  const body = { status, itens };
  const r=await fetch(api()+"/pedidos/"+id,{method:"PUT", headers:{'Content-Type':'application/json'}, body: JSON.stringify(body)});
  out(await r.json());
}
async function atualizarStatus(){
  const id=document.getElementById('p-id2').value;
  const body={ status: document.getElementById('p-status').value };
  const r=await fetch(api()+"/pedidos/"+id+"/status",{method:"PUT", headers:{'Content-Type':'application/json'}, body: JSON.stringify(body)});
  out(await r.json());
}
async function excluirPedido(){ const id=document.getElementById('p-id2').value; const r=await fetch(api()+"/pedidos/"+id,{method:"DELETE"}); out({status:r.status}); }
</script>
</body>
</html>
